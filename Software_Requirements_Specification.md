# FondsPod 需求规格说明书

## 1. 引言

### 1.1 背景
FondsPod 是一个基于档案管理思想的开源文档管理工具，旨在帮助用户高效地组织、存储和检索各种类型的文档和文件。其设计灵感来源于档案管理的核心理念，采用层级化的结构（全宗、案卷、文件、件）来管理文档。

### 1.2 目标
本需求规格说明书旨在明确 FondsPod 的功能需求、非功能需求以及技术实现要求，为开发团队提供清晰的开发指导。

### 1.3 范围
FondsPod 的主要功能包括：
- 档案库管理
- 全宗管理
- 案卷管理
- 文件管理
- Schema 管理
- 设置与配置

### 1.4 定义与缩略语
- **全宗（Fonds）**：档案管理的最高层级，用于组织相关的案卷。
- **案卷（Series）**：全宗下的子集，用于进一步分类文档。
- **文件（File）**：案卷下的具体文档集合。
- **件（Item）**：文件中的具体条目。
- **Schema**：定义案卷或文件的元数据结构。

---

## 2. 系统概述

### 2.1 系统功能
FondsPod 的主要功能模块包括：
- **档案库管理**：创建、管理和切换档案库。
- **全宗管理**：添加、删除、更新全宗及其元数据。
- **案卷管理**：基于 Schema 动态生成案卷，支持案卷的更新。
- **文件管理**：添加、删除、更新文件，支持本地文件夹的操作。
- **Schema 管理**：定义和管理案卷的元数据结构。
- **设置**：支持主题、语言切换及档案库路径配置。

### 2.2 系统架构
FondsPod 采用以下架构：
- **前端**：基于现代 UI 框架，提供用户友好的界面。
- **后端**：基于 SQLite 数据库，存储档案库的元数据。
- **本地文件系统**：用于存储实际的文档和文件。

---

## 3. 功能需求

### 3.1 档案库管理
- 用户可以创建多个档案库，每个档案库关联一个本地目录。
- 档案库的元数据存储在 `.fondspod.db` 文件中。
- 支持切换档案库，默认打开上次使用的档案库。

### 3.2 全宗管理
- 支持添加、删除、更新全宗。
- 全宗的元数据包括：
  - **FondClassification**（全宗分类）
  - **FondSeriesSchemas**（全宗案卷 Schema）
  - **CreatedAt**（创建时间）
- 自动生成全宗编号，格式为 `[FondClassificationCode][两位流水号]`。
- 动态生成 FondSchemas 和 Series。

### 3.3 案卷管理
- 基于 FondSchemas 动态生成案卷。
- 支持案卷的更新，不删除已有案卷。
- 案卷编号格式为各 SchemaItem 的编号拼接。

### 3.4 文件管理
- 支持为案卷添加文件，文件编号格式为 `[FondNo]-[SeriesNo]-[两位流水号]`。
- 支持打开文件对应的本地文件夹。
- 支持删除文件，删除的文件移动到 `.trash` 目录。

### 3.5 Schema 管理
- 支持添加、删除、修改 Schema 和 SchemaItem。
- 初始化时自动生成一个不可修改的 `Year` Schema。
- Schema 的元数据包括：
  - **SchemaNo**（编号）
  - **Name**（名称）
  - **ItemNo**（子项编号）
  - **ItemName**（子项名称）

### 3.6 设置
- 支持主题切换（浅色模式、深色模式）。
- 支持语言切换（中文、英文）。
- 支持配置档案库路径。

---

## 4. 非功能需求

### 4.1 性能需求
- 系统应支持至少 10,000 条全宗记录的快速检索。
- 文件操作（如添加、删除）应在 1 秒内完成。

### 4.2 可用性需求
- 系统应提供直观的用户界面，降低学习成本。
- 提供多语言支持，默认语言为中文。

### 4.3 兼容性需求
- 系统应支持 Windows、MacOS 和 Linux 平台。
- 数据库文件应与 SQLite 兼容。

### 4.4 安全性需求
- 档案库的元数据应加密存储，防止未经授权的访问。
- 删除的文件应移动到 `.trash` 目录，避免误删。

---

## 5. 数据库设计

### 5.1 表结构
- **Schemas**：存储 Schema 的基本信息。
- **SchemaItems**：存储 Schema 的子项。
- **Fonds**：存储全宗的基本信息。
- **Series**：存储案卷的基本信息。
- **Files**：存储文件的基本信息。
- **Items**：存储件的基本信息。
- **FondSchemas**：存储全宗与 Schema 的关联关系。
- **FondClassifications**：存储全宗分类信息。
- **Sequences**：存储编号生成的流水号。

### 5.2 数据关系
- **Schemas** 与 **SchemaItems**：一对多关系。
- **Fonds** 与 **Series**：一对多关系。
- **Series** 与 **Files**：一对多关系。
- **Files** 与 **Items**：一对多关系。

---

## 6. 系统流程

### 6.1 添加全宗
1. 用户填写全宗元数据。
2. 系统生成全宗编号。
3. 系统更新 FondSchemas 和 Series。

### 6.2 添加文件
1. 用户选择案卷并填写文件元数据。
2. 系统生成文件编号。
3. 系统在本地文件系统中创建对应文件夹。

---

## 7. 附录

### 7.1 参考文献
- SQLite 官方文档
- 档案管理相关书籍

### 7.2 缩略语表
- **SRS**：需求规格说明书
- **DB**：数据库

---

**版本号：1.0**
**发布日期：2025年11月21日**